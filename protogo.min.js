window.Protogo=(function(){function protogo(){var a={VERSION:'0.2',AUTHOR:"jbear"};_proto=this;this.MATCH_THRESHOLD=2;this.raw=null;this.fields={}}protogo.prototype={init:function(a){var b=this;_proto.raw=a;_proto.fields={};return this.add(a)},add:function(p){var q=this;if(p.constructor===Array){var r=0;var s={};var t=[];var u=[];var v=q.MATCH_THRESHOLD;var w=Object.keys(p[0]);console.log(w);w.some(function(k){var l;var m;console.log(k);if(typeof _proto.fields[k]!='undefined'){console.log(q.fields[k]);l=(typeof _proto.fields[k].root=='undefined')?{}:_proto.fields[k].root;m=(typeof _proto.fields[k].value_list=='undefined')?[]:_proto.fields[k].value_list}else{l={};m=[]}t.push(k);s[k]=r;u.push(r);var n=p.length;for(var i=0;i<n;i++){var o=p[i][k];m.push(o);q.addOnBasicTrie(l,o,p[i])}_proto.fields[k]={idx:r,value_list:m,root:l,search:function(a){var b=[];var c=this.root;if(q.MATCH_THRESHOLD)v=q.MATCH_THRESHOLD;var d=0;for(var i=0;i<a.length;i++){if(c[a[i]]){c=c[a[i]];d++;continue}else break}if(d>=v){var e=0;var f=0;var g=[];for(var h in c){if(h=="raw"){for(var i=0;i<c[h].length;i++)b.push(c[h][i])}else{g.push(c[h]);f++}}for(e=0;e!=f;e++){for(var j in g[e]){if(j=="raw"){for(var i=0;i<g[e]["raw"].length;i++)b.push(g[e]["raw"][i]);continue}else{g.push(g[e][j]);f++}}}}else{console.log("there is no result")}return b}};_proto[k]=_proto.fields[k];r++});_proto.fields.names=t;_proto.fields.count=r;_proto.fields.get=(_idx)=>{return _proto.fields.names[_idx]};_proto.fields.order=u;return _proto.fields}else{return null}},search:function(a){return this.searchOnBasicTrie(a)},addOnMoebiousTrie:function(a){},addOnBasicTrie:function(a,b,c){var d=b;if(!a[d[0]])a[d[0]]={};var e=a[d[0]];for(var j=1;j<d.length;j++){if(!e[d[j]])e[d[j]]={};e=e[d[j]];if(d[j-1]==' '){if(!a[d[j]])a[d[j]]={};var f=a[d[j]];for(var k=j+1;k<d.length;k++){if(f[d[k]]){f=f[d[k]]}else{f[d[k]]={};f=f[d[k]]}}if(!f["raw"]){f["raw"]=[];f["raw"].push(c)}}}if(!e["raw"])e["raw"]=[];e["raw"].push(c)},searchOnBasicTrie:function(a){var b=[];console.log(this.fields);console.log("field count = "+this.fields.count);for(var i=0;i<this.fields.count;i++){var c=this.fields.order[i];console.log(c);console.log(this.fields.names[c]);var d=this[this.fields.names[c]].search(a);console.log(d);for(var j=0;j<d.length;j++)b.push(d[j])}return b},compare:function(a,b){var c,_second;if(a.length>b.length){c=a;_second=b}else{c=b;_second=a}var d=new Array(c.length+1);for(var i=0;i<=c.length;i++)d[i]=new Array(_second.length+1);for(var i=0;i<c.length+1;i++){d[i][0]=i;if(_second.length>=i)d[0][i]=i}for(var i=1;i<c.length+1;i++){for(var j=1;j<_second.length+1;j++){if(c[i-1]==_second[j-1]){d[i][j]=d[i-1][j-1]}else{var e=d[i-1][j-1];if(d[i-1][j]>d[i][j-1]){if(e>d[i][j-1])e=d[i][j-1]}else{if(e>d[i-1][j])e=d[i-1][j]}d[i][j]=e+1}}}return d[c.length][_second.length]},setOrder:function(a){this.fields.order=a},toString:function(){return JSON.stringify(this.fields)},toHash:function(a){return a.charCodeAt()}};return protogo}());
